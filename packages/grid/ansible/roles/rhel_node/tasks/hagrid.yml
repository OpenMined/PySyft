---
- name: Add /home/{{ om_user }}/.local/bin to PATH in .profile
  ansible.builtin.lineinfile:
    create: true
    path: "/home/{{ om_user }}/.profile"
    line: 'export PATH="$HOME/.local/bin:$PATH"'
    insertafter: EOF
    state: present
  become: yes

- name: Install HAGrid
  shell: "runuser -l {{ om_user }} -c 'pip install -e {{ syft_dir }}/packages/hagrid'"
  become: yes
  when: vagrant is defined

- name: Ensure /root/.profile exists
  ansible.builtin.file:
    path: /root/.profile
    state: touch
  become: yes

- name: Add path for root
  ansible.builtin.lineinfile:
    path: /root/.profile
    line: "export PATH=$PATH:/usr/local/bin"
    state: present
  become: yes

- name: Install HAGrid (temp root)
  shell: "pip install -e {{ syft_dir }}/packages/hagrid"
  become: yes
